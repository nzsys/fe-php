# fe-php Sample Configuration
# All-in-one PHP Application Platform

[server]
host = "0.0.0.0"
port = 8080
# Number of PHP worker threads (USE THIS - not php.worker_pool_size)
# For macOS testing, start with workers = 1
workers = 1

[php]
# Path to libphp.so (adjust for your system)
# FreeBSD: /usr/local/lib/libphp.so
# Debian/Ubuntu: /usr/lib/libphp.so or /usr/lib/x86_64-linux-gnu/libphp.so
# From source: /usr/local/lib/libphp.so
# macOS: /opt/homebrew/lib/libphp.dylib
libphp_path = "/usr/local/lib/libphp.so"

# Document root for PHP files
document_root = "/var/www/html"

# DEPRECATED: worker_pool_size is ignored - use [server] workers instead
# PHP worker pool size
# worker_pool_size = 8

# Max requests per worker before restart (prevents memory leaks)
worker_max_requests = 10000

# Embedded libphp mode (recommended for production - 50-100x faster than PHP-FPM)
# false = Use embedded libphp (FrankenPHP-style, in-process execution)
# true = Fallback to PHP-FPM via FastCGI (if libphp not available)
use_fpm = false

# PHP-FPM socket address (used only when use_fpm = true)
# TCP: "127.0.0.1:9000"
# Unix socket: "/var/run/php-fpm.sock"
fpm_socket = "127.0.0.1:9000"

[php.opcache]
enable = true
memory_size = "256M"
max_files = 10000
# Set to false in production for better performance
validate_timestamps = false

[logging]
# Levels: trace, debug, info, warn, error
level = "info"

# Formats: json, pretty
format = "json"

# Output: stdout, file:/path/to/log
output = "stdout"

[metrics]
enable = true
endpoint = "/_metrics"
port = 9090

[waf]
enable = true
# Modes: off, learn, detect, block
mode = "block"
rules_path = "examples/waf_rules.toml"

[waf.rate_limit]
requests_per_ip = 100
window_seconds = 60
burst = 10

[admin]
enable = true
unix_socket = "/var/run/fe-php.sock"
http_port = 9000
allowed_ips = ["127.0.0.1"]
