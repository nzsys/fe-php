[server]
host = "localhost"
port = 8080
workers = 8

[php]
# Path to libphp.so (adjust for your system)
# FreeBSD: /usr/local/lib/libphp.so
# Debian/Ubuntu: /usr/lib/libphp.so or /usr/lib/x86_64-linux-gnu/libphp.so
# From source: /usr/local/lib/libphp.so
libphp_path = "/usr/local/php-zts-embed/lib/libphp.dylib"

document_root = "/Users/nzsys/Web"
worker_max_requests = 10000
use_fpm = false
fpm_socket = "127.0.0.1:9000"

[php.opcache]
enable = true
memory_size = "256M"
max_files = 10000
validate_timestamps = false

[logging]
level = "info"
format = "json"
output = "stdout"

[metrics]
enable = true
endpoint = "/_metrics"
port = 9090

[waf]
enable = true
mode = "block"
rules_path = "examples/waf_rules.toml"

[waf.rate_limit]
requests_per_ip = 100
window_seconds = 60
burst = 10

[admin]
enable = true
unix_socket = "/var/run/fe-php.sock"
http_port = 9000
allowed_ips = ["127.0.0.1"]

[backend]
enable_hybrid = false
default_backend = "embedded"

[backend.static_files]
enable = false

# [[backend.routing_rules]]
# pattern = { type = "suffix", value = ".jpg" }
# backend = "static"
# priority = 80

# [[backend.routing_rules]]
# pattern = { type = "prefix", value = "/api/" }
# backend = "embedded"
# priority = 90

# [[backend.routing_rules]]
# pattern = { type = "prefix", value = "/admin/" }
# backend = "fastcgi"
# priority = 70
